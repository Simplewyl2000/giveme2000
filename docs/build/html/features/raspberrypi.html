

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>openEuler嵌入式树莓派系统 &mdash; openEuler Embedded在线文档 1.0.0 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> openEuler Embedded在线文档
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">内容</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">快速上手</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">openEuler Embedded关键特性</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yocto/index.html">openEuler Embedded构建系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute_doc.html">如何撰写并贡献文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">版本说明</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">openEuler Embedded在线文档</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>openEuler嵌入式树莓派系统</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/features/raspberrypi.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="openeuler">
<h1>openEuler嵌入式树莓派系统<a class="headerlink" href="#openeuler" title="永久链接至标题">¶</a></h1>
<div class="section" id="id1">
<h2>树莓派镜像构建指导<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p><strong>构建环境</strong></p>
<p>1.构建环境推荐：openEuler-20.03 LTS</p>
<p>2.准备好openEuler Embedded 64位镜像发布件，本次版本使用22.03版本，获取地址:<a class="reference external" href="https://www.openeuler.org/zh/download/">openeuler嵌入式镜像获取</a></p>
<p>3.构建指导: <a class="reference external" href="https://openeuler.gitee.io/yocto-meta-openeuler/getting_started/container-build.html">参考容器构建指导</a></p>
<ul class="simple">
<li>构建命令示例:</li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">su huawei</span>

<span class="go">source /usr1/openeuler/src/yocto-meta-openeuler/scripts/compile.sh raspberrypi4-64 /usr1/openeuler/src/build/build-raspberrypi4-64/</span>

<span class="go">bitbake openeuler-image</span>
</pre></div>
</div>
<ul class="simple">
<li>构建镜像生成目录(示例)：</li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/usr1/openeuler/src/build/build-raspberrypi4-64/output</span>
</pre></div>
</div>
<ul class="simple">
<li>二进制介绍：<ol class="arabic">
<li>Image: 树莓派内核镜像</li>
<li>openeuler-glibc-x86-64-openeuler-image-cortexa72-raspberrypi4-64-toolchain-22.03.30.sh: sdk工具链</li>
<li>openeuler-image-raspberrypi4-64-<a href="#id4"><span class="problematic" id="id5">*</span></a>.rootfs.rpi-sdimg: 树莓派支持sd卡镜像</li>
</ol>
</li>
</ul>
<p><strong>镜像使用方法</strong></p>
<p>1.镜像烧录:</p>
<p>参考: <a class="reference external" href="https://gitee.com/openeuler/raspberrypi/blob/master/documents/%E5%88%B7%E5%86%99%E9%95%9C%E5%83%8F.md">树莓派烧录指导</a></p>
<p>2.镜像使用</p>
<ul class="simple">
<li>使用losetup将磁盘镜像文件虚拟成块设备</li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">lossetup -f --show openEuler_embedded_raspi.img</span>
</pre></div>
</div>
<p>例如，显示结果为/dev/loop0</p>
<ul class="simple">
<li>使用kpartx创建分区表/dev/loop0的设备映射</li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kpartx -va /dev/loop0</span>
</pre></div>
</div>
<p>得到结果将/dev/loop0两个分区设备</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">add map loop0p1</span>
<span class="go">add map loop0p2</span>
</pre></div>
</div>
<p>运行 ls /dev/mapper/loop0p*可以看到分区分别对应两个分区</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/dev/mapper/loop0p1 /dev/mapper/loop0p2</span>
</pre></div>
</div>
<ul class="simple">
<li>分区挂载</li>
</ul>
<p>创建挂载目录</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir ${WORKDIR}/boot ${WORKDIR}/root</span>
</pre></div>
</div>
<p>挂载boot分区</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mount -t vfat -o uid=root,gid=root,umask=0000 /dev/mapper/loop0p1 ${WORKDIR}/boot</span>
</pre></div>
</div>
<p>挂载root分区</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mount -t ext4 /dev/mapper/loop0p2 ${WORKDIR}/root</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>树莓派镜像使用<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p><strong>启用树莓派</strong></p>
<p>版本要求:树莓派4B</p>
<p>默认用户名:root，密码:第一次启动需重新配置，长度大于14位，格式：特殊字符+英文字符+数字</p>
<p>将刷写镜像后的SD卡插入树莓派，通电启用</p>
<p><strong>树莓派登陆方式</strong></p>
<p>1.本地登陆</p>
<p>a.使用串口登陆：</p>
<p>镜像使能了串口登陆功能，按照树莓派的串口连接方式，如下图，可以启用串口操作；</p>
<p>示例：使用ttyusb转接器，将树莓派串口通过usb连接到putty：</p>
<img alt="features/../../image/rasp/rasp-ttyusb-connect.webp" src="features/../../image/rasp/rasp-ttyusb-connect.webp" />
<p>putty配置参考： Serial line:ttyUSB0 speed:115200 Connection type:Serial</p>
<p>b.使用hdmi登陆：</p>
<p>树莓派连接显示器（树莓派视频输出接口为 Micro HDMI）、键盘、鼠标后，启动树莓派，可以看到树莓派启动日志输出到显示器上。待树莓派启动成功，输入用户名（root）和密码登录。</p>
<p>注意：当前镜像默认使能usb串口登陆，如果需要通过hdmi，需要修改相关配置：</p>
<p>（1）修改boot分区下的cmdline参数，添加 console=tty1</p>
<p>（2）将root分区下的/etc/inittab ttyS0修改为tty1</p>
<p>2.ssh 远程登录</p>
<p>参考: <a class="reference external" href="https://gitee.com/openeuler/raspberrypi/blob/master/documents/%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8.md">树莓派使用:启用树莓派:ssh登陆</a></p>
<p><strong>分区扩容</strong></p>
<p>以下内容引用: <a class="reference external" href="https://gitee.com/openeuler/raspberrypi/blob/master/documents/%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8.md">树莓派使用:启用树莓派:分区扩容</a></p>
<p>默认根目录分区空间比较小，在使用之前，需要对分区进行扩容。</p>
<p>1.查看磁盘分区信息</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">执行 fdisk -l 命令查看磁盘分区信息。命令和回显如下：</span>
</pre></div>
</div>
<p>SD 卡对应盘符为 /dev/mmcblk0，包括 2 个分区，分别为</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/dev/mmcblk0p1：引导分区</span>

<span class="go">/dev/mmcblk0p2：根目录分区</span>
</pre></div>
</div>
<p>这里我们需要将根目录分区 /dev/mmcblk0p2 进行扩容。</p>
<p>2.分区扩容</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">执行 fdisk /dev/mmcblk0 命令进入到交互式命令行界面，按照以下步骤扩展分区，如下图所示。</span>

<span class="go">输入 p，查看分区信息。</span>

<span class="go">记录分区 /dev/mmcblk0p2 的起始扇区号，即 /dev/mmcblk0p2 分区信息中 Start 列的值，示例中为 1593344。</span>

<span class="go">输入 d，删除分区。</span>

<span class="go">输入 2 或直接按 Enter，删除序号为 2 的分区，即 /dev/mmcblk0p2 分区。</span>

<span class="go">输入 n，创建新的分区。</span>

<span class="go">输入 p 或直接按 Enter，创建 Primary 类型的分区。</span>

<span class="go">输入 2 或直接按 Enter，创建序号为 2 的分区，即 /dev/mmcblk0p2 分区。</span>

<span class="go">输入新分区的起始扇区号，即第 1 步中记录的起始扇区号，示例中为 1593344。</span>

<span class="go">须知：</span>

<span class="go">请勿直接按“Enter”或使用默认参数。</span>

<span class="go">按 Enter，使用默认的最后一个扇区号作为新分区的终止扇区号。</span>

<span class="go">输入 N，不修改扇区标记。</span>

<span class="go">输入 w，保存分区设置并退出交互式命令行界面。</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h2>树莓派镜像特性介绍<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<p>1.树莓派硬件特性，参考:<a class="reference external" href="https://gitee.com/openeuler/raspberrypi/blob/master/documents/%E6%A0%91%E8%8E%93%E6%B4%BE%E4%BD%BF%E7%94%A8.md#%E5%90%AF%E7%94%A8%E6%A0%91%E8%8E%93%E6%B4%BE">树莓派使用:GPIO介绍</a></p>
<p>目前已使能串口设备，可以访问mini-uart，其他硬件特性暂不支持。</p>
<p>2.支持百级嵌入式软件包，见软件包功能列表</p>
<ol class="arabic simple" start="3">
<li>支持部署rt实时内核</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, openEuler Embedded

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>